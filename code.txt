
CREATE DATABASE CompanyDB;
USE CompanyDB;

CREATE TABLE Location (
    Location_ID INT PRIMARY KEY,
    Regional_Group VARCHAR(255)
);

CREATE TABLE Job (
    Job_Id INT PRIMARY KEY,
    JobRole VARCHAR(255)
);

CREATE TABLE Department (
    Department_Id INT PRIMARY KEY,
    Name VARCHAR(255),
    Location_Id INT,
    FOREIGN KEY (Location_Id) REFERENCES Location(Location_ID)
);

CREATE TABLE Employee (
    Employee_Id INT PRIMARY KEY,
    Last_Name VARCHAR(255),
    First_Name VARCHAR(255),
    Middle_Name CHAR(1),
    Job_Id INT,
    Manager_Id INT,
    Hire_Date DATE,
    Salary INT,
    Comm VARCHAR(255),
    Department_Id INT,
    FOREIGN KEY (Job_Id) REFERENCES Job(Job_Id),
    FOREIGN KEY (Department_Id) REFERENCES Department(Department_Id)
);
SHOW CREATE TABLE Location;
SHOW CREATE TABLE Job;
SHOW CREATE TABLE Department;
SHOW CREATE TABLE Employee;

SELECT * FROM Location;
SELECT * FROM Job;
SELECT * FROM Department;
SELECT * FROM Employee;

SELECT LOWER(Regional_Group) FROM Location;
SELECT First_Name, Last_Name, Salary * 12 AS Annual_Salary FROM Employee;
SELECT CONCAT(Last_Name, ' ', Middle_Name, '. ', First_Name) AS Full_Name FROM Employee;
SELECT * FROM Employee WHERE Last_Name NOT LIKE '%S%';
SELECT * FROM Employee WHERE Department_Id IN (20, 30);
SELECT * FROM Employee WHERE Department_Id IN (20, 30);
SELECT * FROM Employee WHERE Comm IS NULL;
SELECT Department_Id, MAX(Salary) AS Max_Salary, MIN(Salary) AS Min_Salary, AVG(Salary) AS Avg_Salary 
FROM Employee 
GROUP BY Department_Id;
SELECT COUNT(*) FROM Employee WHERE YEAR(Hire_Date) = 1985;
SELECT * FROM Employee WHERE Salary = (SELECT MAX(Salary) FROM Employee);
SELECT d.Name, COUNT(e.Employee_Id) AS Total_Employees
FROM Department d
LEFT JOIN Employee e ON d.Department_Id = e.Department_Id
GROUP BY d.Department_Id;
SELECT d.Name 
FROM Department d
JOIN Employee e ON d.Department_Id = e.Department_Id
GROUP BY d.Name
HAVING COUNT(e.Employee_Id) >= 3
ORDER BY d.Name ASC;
SELECT l.Regional_Group, e.Salary
FROM Employee e
JOIN Department d ON e.Department_Id = d.Department_Id
JOIN Location l ON d.Location_Id = l.Location_ID
WHERE e.Salary = (SELECT MAX(Salary) FROM Employee);
SELECT l.Regional_Group, e.Salary
FROM Employee e
JOIN Department d ON e.Department_Id = d.Department_Id
JOIN Location l ON d.Location_Id = l.Location_ID
WHERE e.Salary = (SELECT MAX(Salary) FROM Employee);
SELECT j.JobRole, COUNT(e.Employee_Id) AS Num_Employees, AVG(e.Salary) AS Avg_Salary
FROM Job j
JOIN Employee e ON j.Job_Id = e.Job_Id
WHERE j.JobRole LIKE '%LE%'
GROUP BY j.JobRole
HAVING COUNT(e.Employee_Id) > 1
ORDER BY Avg_Salary DESC;
CREATE TABLE `Job-Clone` LIKE Job;
INSERT INTO `Job-Clone` SELECT * FROM Job;
ALTER TABLE Employee CHANGE Comm Commission VARCHAR(255);
UPDATE Employee e
JOIN Department d ON e.Department_Id = d.Department_Id
SET e.Salary = e.Salary * 1.1
WHERE d.Name = 'Sales';

SELECT * FROM Employee;
DROP TABLE Employee;
